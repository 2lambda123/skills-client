!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@skills/skills-client-configuration")):"function"==typeof define&&define.amd?define(["exports","@skills/skills-client-configuration"],t):t((e=e||self).SkillsReporter={},e.SkillsConfiguration)}(this,(function(e,t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var n=new Set,o=new Set,r=function(e){n.forEach((function(t){return t(e)}))},s=function(e){o.forEach((function(t){return t(e)}))},i=function(e,n,o,r){var s=this;new Promise((function(e,n){var o=new XMLHttpRequest;o.open("GET",t.getAuthenticator()),o.onreadystatechange=function(){if(4===o.readyState)if(200!==o.status)n(new Error("Unable to authenticate"));else{var t=JSON.parse(o.response);t.access_token?e(t.access_token):n(new Error("Unable to authenticate"))}},o.send()})).then((function(i){t.setAuthToken(i),s.reportSkill(e,n+1).then((function(e){o(e)})).catch((function(e){r(e)}))})).catch((function(e){r(e)}))},a={addSuccessHandler:function(e){n.add(e)},addErrorHandler:function(e){o.add(e)},reportSkill:function(e){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(t.validate(),o>=25)throw new Error("Unable to authenticate after 25 attempts");var a=0;void 0!==o&&(a=o);var c=new Promise((function(o,r){if(t.getAuthToken()||t.isPKIMode()){var s=new XMLHttpRequest;s.open("POST","".concat(t.getServiceUrl(),"/api/projects/").concat(t.getProjectId(),"/skills/").concat(e)),s.withCredentials=!0,t.isPKIMode()||s.setRequestHeader("Authorization","Bearer ".concat(t.getAuthToken())),s.onreadystatechange=function(){4===s.readyState&&(200!==s.status&&0!==s.status&&401!==s.status?r(JSON.parse(s.response)):401!==s.status&&0!==s.status||t.isPKIMode()?o(JSON.parse(s.response)):i.call(n,e,a,o,r))},s.send()}else i.call(n,e,a,o,r)}));return c.then((function(e){r(e)})),c.catch((function(e){s(e)})),c}};e.FAILURE_EVENT="skills-report-error",e.SUCCESS_EVENT="skills-report-success",e.SkillsReporter=a,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=SkillsReporter.umd.min.js.map
